!function(e){function t(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,s){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:s})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RECOMMEND_URL="https://qq-music-api.now.sh",t.TOPLIST_URL="https://qq-music-api.now.sh/top",t.SEARCH_URL="https://qq-music-api.now.sh/search",t.LYRICS_URL="https://qq-music-api.now.sh/lyrics",t.HOTKEYS_URL="https://shenzekun-qmusic-api.now.sh/hotkey"},function(e,t,i){"use strict";function s(e){return"http://isure.stream.qqmusic.qq.com/C100"+e+".m4a?fromtag=32"}function n(e){return o.LYRICS_URL+"?id="+e}function r(e){return"https://y.gtimg.cn/music/photo_new/T002R150x150M000"+e+".jpg"}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return o.SEARCH_URL+"?keyword="+e+"&page="+t}Object.defineProperty(t,"__esModule",{value:!0}),t.songUrl=s,t.lyricsUrl=n,t.albumCoverUrl=r,t.searchUrl=a;var o=i(0)},function(e,t,i){"use strict";function s(e){function t(e){var t=e.getBoundingClientRect(),i=t.top,s=t.left,n=t.right,r=t.bottom,a=document.documentElement.clientWidth,o=document.documentElement.clientHeight;return(i>0&&i<o||r>0&&r<o)&&(s>0&&s<a||n>0&&n<a)}function i(e,t){var i=new Image;i.src=e.dataset.src,i.onload=function(){e.src=i.src,e.classList.remove("lazyload"),"function"==typeof t&&t()}}var s=e?[].slice.call(e):document.querySelectorAll(".lazyload");if("IntersectionObserver"in window){var n=new IntersectionObserver(function(e){e.forEach(function(e){e.intersectionRatio>0&&i(e.target,function(){n.unobserve(e.target)})})},{threshold:.01});s.forEach(function(e){return n.observe(e)})}else{var r=function(e,t){var i=void 0,s=void 0;return function n(){var r=Date.now(),a=r-i;!i||a>=t?(e(),i=r):a<t&&(clearTimeout(s),s=setTimeout(n,t-a))}}(function(){if(0===s.length)return window.removeEventListener("scroll",r);s=s.filter(function(e){return e.classList.contains("lazyload")}),s.forEach(function(e){return t(e)&&i(e)})},300);window.addEventListener("scroll",r),window.dispatchEvent(new Event("scroll"))}}Object.defineProperty(t,"__esModule",{value:!0}),t.lazyload=s},function(e,t,i){"use strict";function s(){var e=location.hash;if(/^#player\?.+/.test(e)){var t=e.slice(e.indexOf("?")+1).match(/(\w+)=([^&]+)/g),i=t&&t.reduce(function(e,t){var i=t.split("=");return e[i[0]]=decodeURIComponent(i[1]),e},{});c.play(i)}else c.hide()}i(4);var n=i(5),r=i(6),a=i(7),o=i(10),l=i(13),c=(new n.Search(document.querySelector("#search-view")),new o.MusicPlayer(document.querySelector("#player")));new r.TopList(document.querySelector("#rank-view")).launch(),new a.Recommend(document.querySelector("#rec-view")).launch(),new l.HotKey(document.querySelector(".result-tags")).start();document.querySelector(".show-player").addEventListener("click",function(){c.show()}),s(),addEventListener("hashchange",s)},function(e,t,i){"use strict";document.addEventListener("click",function(e){var t=e.target;if("tab"===t.dataset.role){[].forEach.call(t.parentElement.children,function(e){e.classList.remove("active")}),t.classList.add("active");var i=document.querySelector(t.dataset.view);i&&([].forEach.call(i.parentElement.children,function(e){e.style.display="none"}),i.style.display="block"),window.dispatchEvent(new Event("scroll"))}})},function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Search=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),r=(i(0),i(1));t.Search=function(){function e(t){s(this,e),this.$el=t,this.$input=this.$el.querySelector("#search"),this.$input.addEventListener("keyup",this.onKeyUp.bind(this)),this.$songs=this.$el.querySelector(".song-list"),this.page=1,this.songs={},this.keyword="",this.perpage=20,this.nomore=!1,this.fetching=!1,this.history=[],this.delete=document.querySelector(".icon-delete"),this.cancel=document.querySelector(".search-cancel"),this.hotKeys=document.querySelector("#hot-keys"),this.recordKeys=document.querySelector(".record-keys"),this.onscroll=this.onScroll.bind(this),this.$el.addEventListener("click",this.onClick.bind(this)),this.HISTORY_KEY="search_history",this.history=localStorage.getItem(this.HISTORY_KEY)?localStorage.getItem(this.HISTORY_KEY).split(","):[]}return n(e,[{key:"onKeyUp",value:function(e){var t=e.target.value.trim();if(!t)return this.delete.classList.add("hide"),this.reset();this.delete.classList.remove("hide"),13===e.keyCode&&(this.recordKeys.classList.add("hide"),this.addHistory(t),this.search(t),window.addEventListener("scroll",this.onscroll))}},{key:"onClick",value:function(e){if(e.target===this.$input&&(this.cancel.classList.remove("hide"),this.hotKeys.classList.add("hide"),this.recordKeys.classList.remove("hide"),this.renderHistory(),this.reset()),e.target===this.cancel&&(this.cancel.classList.add("hide"),this.delete.classList.add("hide"),this.hotKeys.classList.remove("hide"),this.recordKeys.classList.add("hide"),this.$input.value="",this.reset()),e.target===this.delete&&(this.$input.value="",this.delete.classList.add("hide"),this.reset()),e.target.matches(".record-delete")&&(this.history=[],localStorage.setItem(this.HISTORY_KEY,this.history),this.recordKeys.innerHTML=""),e.target.matches(".icon-close")){var t=this.history.indexOf(e.target.previousElementSibling.innerHTML);this.history.splice(t,1),localStorage.setItem(this.HISTORY_KEY,this.history),this.renderHistory()}(e.target.matches(".tag-keyword")||e.target.matches(".record-con"))&&(this.$input.value=e.target.innerHTML,this.keyword=e.target.innerHTML,this.delete.classList.remove("hide"),this.cancel.classList.remove("hide"),this.hotKeys.classList.add("hide"),this.recordKeys.classList.add("hide"),this.addHistory(this.keyword),this.search(this.keyword),window.addEventListener("scroll",this.onscroll))}},{key:"onScroll",value:function(e){if(this.nomore)return window.removeEventListener("scroll",this.onscroll);pageYOffset+document.documentElement.clientHeight>document.body.scrollHeight-50&&this.search(this.keyword,this.page+1)}},{key:"reset",value:function(){this.page=1,this.songs={},this.keyword="",this.nomore=!1,this.$songs.innerHTML="",this.$el.querySelector(".search-loading").classList.remove("show"),this.$el.querySelector(".loading-icon").classList.remove("dis"),this.$el.querySelector(".loading-text").classList.remove("dis"),this.$el.querySelector(".loading-done").classList.add("hide")}},{key:"search",value:function(e,t){var i=this;this.keyword===e&&this.songs[t||this.page]||this.nomore||this.fetching||(this.keyword!==e&&this.reset(),this.keyword=e,this.loading(),fetch((0,r.searchUrl)(this.keyword,t||this.page)).then(function(e){return e.json()}).then(function(e){return i.page=e.data.song.curpage,i.songs[i.page]=e.data.song.list,i.nomore="no results"===e.message,e.data.song.list}).then(function(e){return i.append(e)}).then(function(){return i.done()}).catch(function(){return i.fetching=!1}))}},{key:"append",value:function(e){console.log(e);var t=e.map(function(e){var t=e.singer.map(function(e){return e.name}).join(" ");return'\n        <a class="song-item" \n           href="#player?artist='+t+"&songid="+e.songid+"&songname="+e.songname+"&albummid="+e.albummid+"&songmid="+e.songmid+"&duration="+e.interval+'">\n          <i class="icon icon-music"></i>\n          <div class="song-name ellipsis">'+e.songname+'</div>\n          <div class="song-artist ellipsis">'+t+"</div>\n        </a>"}).join("");this.$songs.insertAdjacentHTML("beforeend",t)}},{key:"addHistory",value:function(e){-1===this.history.indexOf(e)&&(this.history.unshift(e),localStorage.setItem(this.HISTORY_KEY,this.history))}},{key:"renderHistory",value:function(){if(this.history.length>0){var e=this.history.map(function(e){return'\n            <li>\n                <a href="#" class="record-main">\n                    <span class="icon icon-clock"></span>\n                    <span class="record-con ellipsis">'+e+'</span>\n                    <span class="icon icon-close"></span>\n                </a>\n            </li>\n        '}).join("");e+='\n            <p class="record-delete">清除搜索记录</p>\n        ',this.recordKeys.innerHTML=e}else 0===this.history.length&&(this.recordKeys.innerHTML="",this.history=[])}},{key:"loading",value:function(){this.fetching=!0,this.$el.querySelector(".search-loading").classList.add("show")}},{key:"done",value:function(){this.fetching=!1,this.nomore?(this.$el.querySelector(".loading-icon").classList.add("dis"),this.$el.querySelector(".loading-text").classList.add("dis"),this.$el.querySelector(".loading-done").classList.remove("hide"),this.$el.querySelector(".search-loading").classList.add("show")):this.$el.querySelector(".search-loading").classList.remove("show")}}]),e}()},function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.TopList=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),r=i(2),a=i(0);t.TopList=function(){function e(t){s(this,e),this.$el=t}return n(e,[{key:"launch",value:function(){var e=this;return fetch(a.TOPLIST_URL).then(function(e){return e.json()}).then(function(t){return e.list=t.data.topList}).then(function(){return e.render()}),this}},{key:"render",value:function(){var e=this;this.$el.querySelector("#rank-view .toplist").innerHTML=this.list.map(function(t){return'<li class="top-item">\n         <div class="top-item-media">\n           <a href="#">\n             <img class="lazyload" data-src="'+t.picUrl+'">\n           </a>\n         </div>\n         <div class="top-item-info">\n           <h3 class="top-item-title ellipsis">'+t.topTitle+'</h3>\n           <ul class="top-item-list">'+e.songlist(t.songList)+"</ul>\n         </div>\n       </li>"}).join(""),(0,r.lazyload)(document.querySelectorAll("#rank-view .toplist .lazyload"))}},{key:"songlist",value:function(e){return e.map(function(e,t){return'<li class="top-item-song">\n         <i class="song-index">'+(t+1)+'</i>\n         <span class="song-name">'+e.songname+"</span>- "+e.singername+"\n       </li>"}).join("")}}]),e}()},function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Recommend=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),r=i(8),a=i(9),o=i(2),l=i(0);t.Recommend=function(){function e(t){s(this,e),this.$el=t}return n(e,[{key:"launch",value:function(){var e=this;return fetch(l.RECOMMEND_URL).then(function(e){return e.json()}).then(function(t){return e.json=t}).then(function(){return e.render()}),this}},{key:"render",value:function(){this.renderSlider(this.json.data.slider),this.renderRadios(this.json.data.radioList),this.renderPlayLists(this.json.data.songList),(0,o.lazyload)(document.querySelectorAll("#rec-view .lazyload")),(0,r.loading)()}},{key:"renderSlider",value:function(e){this.slider=new a.Slider({el:this.$el.querySelector("#slider"),slides:e.map(function(e){return{link:e.linkUrl,image:e.picUrl}})})}},{key:"renderRadios",value:function(e){this.$el.querySelector(".radios .list").innerHTML=e.map(function(e){return'<div class="list-item">\n         <div class="list-media">\n           <img class="lazyload" data-src="'+e.picUrl+'">\n           <span class="icon icon-play"></span>\n         </div>\n         <div class="list-detail">\n           <h3 class="list-title">'+e.Ftitle+"</h3>\n         </div>\n       </div>"}).join("")}},{key:"renderPlayLists",value:function(e){this.$el.querySelector(".playlists .list").innerHTML=e.map(function(e){return'<div class="list-item">\n         <div class="list-media">\n           <img class="lazyload" data-src="'+e.picUrl+'">\n           <span class="icon icon-play"></span>\n         </div>\n         <div class="list-detail">\n           <h3 class="list-title">'+e.songListDesc+'</h3>\n           <div class="list-text"></div>\n         </div>\n       </div>'}).join("")}}]),e}()},function(e,t,i){"use strict";function s(){document.querySelector(".tab-contents").classList.remove("hide"),document.querySelector(".loading_box").classList.add("hide")}Object.defineProperty(t,"__esModule",{value:!0}),t.loading=s},function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();t.Slider=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,e),this.el=t.el,this.slides=t.slides,this.interval=t.interval||2e3,this.index=0,this.width=0,this.touchX=0,this.ready_moved=!0,this.render(),this.bindEvent(),this.start(),this.onresize()}return n(e,[{key:"onresize",value:function(){var e=this;window.addEventListener("resize",function(){e.width=e.el.clientWidth})}},{key:"render",value:function(){this.el.innerHTML='<div class="qq-slider-wrap"></div>\n      <p class="ui-slider-dots">\n      <b class="active"></b>\n      <b class=""></b>\n      <b class=""></b>\n      <b class=""></b>\n      <b class=""></b>\n      </p>',this.dots=document.querySelector(".ui-slider-dots"),this.wrap=this.el.firstElementChild,this.wrap.style.width=100*(this.slides.length+1)+"%",this.wrap.innerHTML=this.slides.map(function(e){return'<div class="qq-slider-item">\n        <a href="'+e.link+'">\n          <img src="'+e.image+'">\n        </a>\n    </div>'}).join(""),this.width=this.el.clientWidth;var e=this.wrap.firstElementChild;this.wrap.insertAdjacentHTML("beforeend",this.domToString(e))}},{key:"domToString",value:function(e){var t=document.createElement("div");t.appendChild(e.cloneNode(!0));var i=t.innerHTML;return t=e=null,i}},{key:"autoPlay",value:function(){this.timer=setInterval(this.next.bind(this),this.interval)}},{key:"start",value:function(){this.autoPlay()}},{key:"next",value:function(){this.index===this.slides.length&&(this.index=0,this.wrap.style.left="0"),this.index+=1,this.animate(this.wrap,-this.width*this.index),this.setActiveDot()}},{key:"animate",value:function(e,t){clearInterval(e.timer),e.timer=setInterval(function(){var i=e.offsetLeft,s=(t-i)/2;s=s>0?Math.ceil(s):Math.floor(s),i+=s,e.style.left=i+"px",i===t&&clearInterval(e.timer)},30)}},{key:"pre",value:function(){0===this.index&&(this.index=this.slides.length,this.wrap.style.left="-"+this.index*this.width+"px"),this.index-=1,this.animate(this.wrap,-this.index*this.width),this.setActiveDot()}},{key:"setActiveDot",value:function(){for(var e=this.dots.children.length,t=0;t<=e;t++){var i=document.getElementsByTagName("b")[t];i&&i.classList.remove("active"),this.index===t&&i&&i.classList.add("active"),5===this.index&&(i=document.getElementsByTagName("b")[0],i.classList.add("active"))}}},{key:"bindEvent",value:function(){this.wrap.addEventListener("touchstart",this.touchstart.bind(this)),this.wrap.addEventListener("touchmove",this.touchmove.bind(this)),this.wrap.addEventListener("touchend",this.touchend.bind(this))}},{key:"touchstart",value:function(e){if(clearInterval(this.timer),this.ready_moved){var t=e.targetTouches[0];this.touchX=t.clientX,this.ready_moved=!1}}},{key:"touchmove",value:function(e){if(e.preventDefault(),e.stopPropagation(),clearInterval(this.timer),!this.ready_moved){var t=e.changedTouches[0],i=t.clientX,s=i-this.touchX,n=-this.index*this.width;s>0&&s<=this.width&&n+s<0?this.animate(this.wrap,n+s):s<0&&Math.abs(s)<=this.width&&n-Math.abs(s)>-this.slides.length*this.width?this.animate(this.wrap,n-Math.abs(s)):n+s>0?(0===this.index&&(this.index=this.slides.length,this.wrap.style.left="-"+this.index*this.width+"px"),this.animate(this.wrap,-this.index*this.width+s)):n-s<this.width*this.slides.length&&(this.index===this.slides.length&&(this.index=0,this.wrap.style.left="-"+this.index*this.width+"px"),this.animate(this.wrap,-this.index*this.width-s))}}},{key:"touchend",value:function(e){var t=this;if(!t.ready_moved){clearInterval(t.timer);var i=e.changedTouches[0],s=i.clientX,n=s-t.touchX;n>t.width/3?(t.pre(),t.autoPlay(),t.ready_moved=!0):n<-t.width/3?(t.next(),t.autoPlay(),t.ready_moved=!0):(t.animate(t.wrap,-t.index*t.width),t.autoPlay(),t.ready_moved=!0)}}}]),e}()},function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.MusicPlayer=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),r=i(11),a=i(12),o=i(1);t.MusicPlayer=function(){function e(t){s(this,e),this.$el=t,this.$el.addEventListener("click",this),this.$audio=this.createAudio(),this.lyrics=new a.LyricsPlayer(this.$el.querySelector(".player-lyrics"),this.$audio),this.progress=new r.ProgressBar(this.$el.querySelector(".progress")),this.fetching=!1}return n(e,[{key:"createAudio",value:function(){var e=this,t=document.createElement("audio");return t.id="player-"+Math.floor(100*Math.random())+"-"+ +new Date,t.addEventListener("ended",function(){e.$audio.play(),e.lyrics.restart(),e.progress.restart()}),document.body.appendChild(t),t}},{key:"handleEvent",value:function(e){var t=e.target;switch(!0){case t.matches(".icon-play"):this.onPlay(e);break;case t.matches(".icon-pause"):this.onPause(e);break;case t.matches(".icon-list"):this.hide()}}},{key:"onPlay",value:function(e){this.fetching||(this.$audio.play(),this.lyrics.start(),this.progress.start(),e.target.classList.add("icon-pause"),e.target.classList.remove("icon-play"))}},{key:"onPause",value:function(e){this.$audio.pause(),this.lyrics.pause(),this.progress.pause(),e.target.classList.add("icon-play"),e.target.classList.remove("icon-pause")}},{key:"play",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t){this.$el.querySelector(".song-name").innerText=t.songname,this.$el.querySelector(".song-artist").innerText=t.artist,this.progress.reset(t.duration);var i=(0,o.albumCoverUrl)(t.albummid);this.$el.querySelector(".album-cover").src=i,this.$el.querySelector(".player-background").style.backgroundImage="url("+i+")",t.songid&&(this.songid!==t.songid&&(this.$el.querySelector(".icon-action").className="icon-action icon-play"),console.log(t),this.songmid=t.songmid,this.songid=t.songid,this.$audio.src=(0,o.songUrl)(this.songmid),this.fetching=!0,fetch((0,o.lyricsUrl)(this.songid)).then(function(e){return e.json()}).then(function(e){return e.lyric}).then(function(t){return e.lyrics.reset(t)}).catch(function(){}).then(function(){return e.fetching=!1})),this.show()}}},{key:"show",value:function(){this.$el.classList.add("show"),document.body.classList.add("noscroll")}},{key:"hide",value:function(){this.$el.classList.remove("show"),document.body.classList.remove("noscroll")}}]),e}()},function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();t.ProgressBar=function(){function e(t,i,n){s(this,e),this.$el=t,this.elapsed=0,this.duration=i||0,this.progress=0,this.render(),this.$progress=this.$el.querySelector(".progress-bar-progress"),this.$elapsed=this.$el.querySelector(".progress-elapsed"),this.$duration=this.$el.querySelector(".progress-duration"),this.$elapsed.innerText=this.formatTime(this.elapsed),this.$duration.innerText=this.formatTime(this.duration),n&&this.start()}return n(e,[{key:"start",value:function(){this.pause(),this.intervalId=setInterval(this.update.bind(this),50)}},{key:"pause",value:function(){clearInterval(this.intervalId)}},{key:"update",value:function(){this.elapsed+=.05,this.elapsed>=this.duration&&this.reset(),this.progress=this.elapsed/this.duration,this.$progress.style.transform="translate("+(100*this.progress-100)+"%)",this.$elapsed.innerText=this.formatTime(this.elapsed)}},{key:"reset",value:function(e){this.pause(),this.elapsed=0,this.progress=0,this.$progress.style.transform="translate(-100%)",this.$elapsed.innerText=this.formatTime(this.elapsed),e&&(this.duration=+e,this.$duration.innerText=this.formatTime(this.duration))}},{key:"restart",value:function(){this.reset(),this.start()}},{key:"render",value:function(){this.$el.innerHTML='\n      <div class="progress-time progress-elapsed"></div>\n        <div class="progress-bar">\n          <div class="progress-bar-progress"></div>\n        </div>\n      <div class="progress-time progress-duration"></div>\n    '}},{key:"formatTime",value:function(e){var t=Math.floor(e/60),i=Math.floor(e%60);return t<10&&(t="0"+t),i<10&&(i="0"+i),t+":"+i}}]),e}()},function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();(t.LyricsPlayer=function(){function e(t,i){s(this,e),this.$el=t,this.$el.innerHTML='<div class="player-lyrics-lines"></div>',this.$lines=this.$el.querySelector(".player-lyrics-lines"),this.$audio=i,this.text="",this.index=0,this.lyrics=[],this.elapsed=0,this.reset(this.text)}return n(e,[{key:"start",value:function(){this.pause(),this.intervalId=setInterval(this.update.bind(this),1e3)}},{key:"pause",value:function(){clearInterval(this.intervalId)}},{key:"update",value:function(){if(this.elapsed=Math.round(this.$audio?this.$audio.currentTime:this.elapsed+1),this.index!==this.lyrics.length-1){for(var e=this.index+1;e<this.lyrics.length;e++){var t=this.getSeconds(this.lyrics[e]);if(this.elapsed===t&&(!this.lyrics[e+1]||this.elapsed<this.getSeconds(this.lyrics[e+1]))){this.$lines.children[this.index].classList.remove("active"),this.$lines.children[e].classList.add("active"),this.index=e;break}}if(this.index>2){var i=-(this.index-2)*this.LINE_HEIGHT;this.$lines.style.transform="translateY("+i+"px)"}}}},{key:"render",value:function(){var e=this.lyrics.map(function(e){return'\n      <div class="player-lyrics-line">'+e.slice(10)+"</div>\n    "}).join("");this.$lines.innerHTML=e}},{key:"reset",value:function(e){this.pause(),this.index=0,this.elapsed=0,this.$lines.style.transform="translateY(0)";var t=this.$lines.querySelector(".active");t&&t.classList.remove("active"),e&&(this.text=this.formatText(e)||"",this.lyrics=this.text.match(/^\[\d{2}:\d{2}.\d{2}\](.+)$/gm)||[],this.lyrics.length&&this.render()),this.lyrics.length&&this.$lines.children[this.index].classList.add("active")}},{key:"restart",value:function(){this.reset(),this.start()}},{key:"getSeconds",value:function(e){return+e.replace(/^\[(\d{2}):(\d{2}).*/,function(e,t,i){return 60*+t+ +i})}},{key:"formatText",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText}}]),e}()).prototype.LINE_HEIGHT=42},function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.HotKey=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),r=i(0);t.HotKey=function(){function e(t){s(this,e),this.el=t}return n(e,[{key:"start",value:function(){var e=this;fetch(r.HOTKEYS_URL).then(function(e){return e.json()}).then(function(t){return e.render(t.data)})}},{key:"render",value:function(e){var t=e.hotkey,i=this.shuffle(t,6).map(function(e){return'\n            <a href="#" class="tag tag-keyword">'+e.k+"</a>\n        "});this.el.innerHTML='<a href="'+e.special_url+'" class="tag tag-hot">'+e.special_key+"</a>"+i}},{key:"shuffle",value:function(e,t){for(var i=[],s=Math.min(t,e.length),n=0;n<s;n++){var r=e,a=Math.floor(Math.random()*r.length);i[n]=r[a],e.splice(a,1)}return i}}]),e}()}]);